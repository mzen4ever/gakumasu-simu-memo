# Score Exporter 拡張機能セットアップ手順

この拡張機能は、gktools.ris.moe で表示されるスコアとステージ情報を Google スプレッドシートに送信します。

---

## 1. Google スプレッドシートのコピーと Webhook URL の発行

https://github.com/user-attachments/assets/9a7552bc-c083-4ee6-8e17-b38895bc5749

1. 以下のテンプレートスプレッドシートを開いて「ファイル」＞「コピーを作成」を選択  
   [テンプレートシートを開く](https://docs.google.com/spreadsheets/d/1CGYGaRDrwSilKyTSfuyIyMcH_3A9F2bcEmjiFDMNsm0/edit?usp=sharing)
2. コピー先のシートで「拡張機能」＞「Apps Script」を開く
3. 以下の `doPost` コードが含まれていることを確認（すでに貼られています）

4. 上部メニュー「デプロイ」＞「新しいデプロイ」
   - 種類：ウェブアプリ
   - 実行する関数：doPost
   - アクセス権：全員（匿名ユーザー含む）
5. 表示された `/exec` で終わる URL をコピー（後で拡張機能に設定します、これがWebhook URL）

---

## 2. Chrome拡張機能のインストール手順（ローカル読み込み）とWebhook URL の設定

1. 下記リンクからリポジトリをダウンロードし、ZIPを解凍する  
   [ファイル](https://github.com/mzen4ever/gakumasu-simu-memo/archive/refs/heads/main.zip)
2. Chrome の拡張機能ページ（chrome://extensions/）を開く
3. 右上の「デベロッパーモード」をオンにする
4. 「パッケージ化されていない拡張機能を読み込む」をクリックし、解凍したフォルダを選択
5. Score Exporter の「詳細」＞「オプション」をクリック
6. 発行した Webhook URL を貼り付けて「保存」
7. 拡張機能が追加され、「スプレッドシートに送信」ボタンが表示される

---

## 3. list シートの作成と設定

#### list シートの編集方法

1. gktools シミュレータ上でアイドル固有カードの「番号（数字）」を確認する
![カード番号の見つけ方](https://github.com/mzen4ever/gakumasu-simu-memo/blob/main/images/url_idol_number.png)

2. 「未強化」と「強化後」の 2 種類のカード番号を list シートのcardNumberの列に行追加する
3. 表示したい名前（アイドル名や衣装名など）を右の列（B列）に記入する

例：

| A列（cardNumber） | B列（名前）     |
|------------------|----------------|
| 544              | あ〇ふらい     |
| 123              | m〇ri       |
| 999              | こ〇ろ       |

---

## 4. 拡張機能の使い方

1. gktools.ris.moe/simulator を開く
2. ステージとスコアを表示（シミュレーション完了後）
3. 拡張機能ボタンをクリックすると、該当ステージのシートに自動で記録されます

### 備考入力機能について

スプレッドシートに送信する際、「備考」欄に自由なメモを記入して一緒に記録することができます。  
これは拡張機能のポップアップ画面に追加された入力欄から操作します。

#### 使用方法

1. 拡張機能アイコンをクリックしてポップアップを開く
2. 上部に表示される「備考（任意）」欄に、自由に文字を入力する
3. 「スプレッドシートに送信」ボタンをクリックすると、スコア情報とともに備考も送信されます

#### スプレッドシートでの反映

- ステージ名に対応するシートの **F列「備考」** に記録されます
- シート作成時には、「備考」列が自動的にヘッダーとして設定されます（フィルター付き）
- 空欄でも送信は可能で、その場合は空のセルとして記録されます


---

不明点があれば、配布元に問い合わせてください。
